# fo:float

## Summary

The `fo:float` formatting object is typically used either to cause an image to be positioned in a separate area at the beginning of a page (a before-float), or to cause an image to be positioned to one side, with normal content flowing around and along-side the image (a side-float).

<!-- Source: https://www.w3.org/TR/xslfo20/#fo_float -->

## Areas

The `fo:float` generates an optional single area with area-class "xsl-anchor", and one or more block-areas that all share the same area-class, which is either "xsl-before-float", "xsl-side-float" or "xsl-normal" as specified by the `float` property. (An `fo:float` generates normal block-areas if its `float` property value is "none".)

Areas with area-class "xsl-side-float" are reference areas.

An area with area-class "xsl-before-float" is placed as a child of a before-float-reference-area.

The optional area with area-class "xsl-anchor" is not generated if the `float` property value is "none", or if, due to an error as described in the constraints section, the `fo:float` shall be formatted as though its `float` property was "none". Otherwise, the area with area-class "xsl-anchor" shall be generated.

The area with area-class "xsl-anchor" has no children, and is an inline-area, except where this would violate the constraints that (a) any area's children must be either block-areas or inline-areas, but not a mixture, and (b) the children of a line-area may not consist only of anchor areas. In the case where an inline-area would violate these constraints, the `fo:float` must instead generate a block-area.

## Constraints

- The normal inline-area generated by the `fo:float` shall be placed in the area tree as though the `fo:float` had a `keep-with-previous` property with value "always". The inline-area has a length of zero for both the `inline-progression-dimension` and `block-progression-dimension`.
- No area may have more than one child block-area with the same area-class returned by the same `fo:float` formatting object.
- Areas with area-class "xsl-before-float" must be properly ordered within the area tree relative to other areas with the same area-class.
- The padding-, border-, and content-rectangles of the block-areas generated by `fo:float` all coincide. That is, the `padding` and `border` are zero at all edges of the area.
- For before-floats: It is an error if the `fo:float` occurs as a descendant of a flow that is not assigned to one or more region-body regions, or of an `fo:block-container` that generates absolutely positioned areas. In either case, the `fo:float` shall be formatted as though its `float` property was "none".
- For before-floats: The `clear` property does not apply.
- For side-floats: Each side-float is placed either as a child of the nearest ancestor reference-area of the anchor-area or as a child of a later reference-area in the same reference-area chain. Side-floats that are siblings in the area-tree may overlap their content rectangles.
- For side-floats: The description in section 9.5 of CSS2 shall be used to determine the formatting, with references to left/right interpreted as writing-mode relative directions "start" and "end", and top/bottom as "before" and "after".

## Content Model

<!-- Source: https://www.w3.org/TR/xslfo20/#fo_float -->
```xml
(%block;)+
```

An `fo:float` is not permitted to have an `fo:float`, `fo:footnote`, or `fo:marker` as a descendant. Additionally, an `fo:float` is not permitted to have as a descendant an `fo:block-container` that generates an absolutely positioned area.

## Properties

| Property | Inherited | Conformance Level |
|---|---|---|
| `float` | no | Extended |
| `clear` | no | Extended |
| `id` | N/A | Basic |
| `index-class` | N/A | Extended |
| `index-key` | N/A | Extended |

## Usage Notes

- When `float="none"`, the `fo:float` generates normal block-areas and behaves essentially like a block container (no floating occurs).
- When `float="start"` or `float="end"`, a side-float is created. Content from following formatting objects flows around the float. The side-float derives its inline-progression-dimension intrinsically from its child areas.
- When `float="before"`, a before-float is created. The float content is placed in the before-float-reference-area at the top of the page.
- Floats cannot be nested: an `fo:float` may not contain another `fo:float`, `fo:footnote`, or `fo:marker`.
- The `clear` property on other formatting objects controls whether they should be placed below (clear of) preceding side-floats.

## Code Samples

The following three-part example from the spec demonstrates a floating figure: the source XML, the XSLT stylesheet that produces `fo:float`, and the resulting XSL-FO output.

**Source XML with a figure/photo element to be floated:**

<!-- Source: xslspec.xml line 16700 -->
```xml
<doc>
  <p>C'ieng pieces were made in northern towns, such as C'ieng Mai.
They were typically of tamlung weight.</p>
  <figure>
    <photo image="TH0317A.jpg"/>
    <caption>C'ieng Tamlung of C'ieng Mai</caption>
  </figure>
</doc>
```

**XSLT stylesheet using `fo:float` with `float="before"` to place the figure at the top of the page:**

<!-- Source: xslspec.xml line 16714 -->
```xml
<?xml version='1.0'?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:fo="http://www.w3.org/1999/XSL/Format"
                version='1.0'>

<xsl:template match="p">
  <fo:block>
    <xsl:apply-templates/>
  </fo:block>
</xsl:template>

<xsl:template match="figure">
  <fo:float float="before">
    <xsl:apply-templates/>
  </fo:float>
</xsl:template>

<xsl:template match="photo">
  <fo:block text-align="center">
    <fo:external-graphic src="{@image}"/>
  </fo:block>
</xsl:template>

<xsl:template match="caption">
  <fo:block space-before="3pt" text-align="center"
    start-indent="10mm" end-indent="10mm">
    <xsl:apply-templates/>
  </fo:block>
</xsl:template>

</xsl:stylesheet>
```

**Resulting XSL-FO output with `fo:float float="before"` containing the image and caption:**

<!-- Source: xslspec.xml line 16749 -->
```xml
<fo:block>C'ieng pieces were made in northern towns,
such as C'ieng Mai. They were typically of tamlung weight.
</fo:block>

<fo:float float="before">

  <fo:block text-align="center">
    <fo:external-graphic src="TH0317A.jpg">
    </fo:external-graphic>
  </fo:block>

  <fo:block space-before="3pt" text-align="center" start-indent="10mm"
    end-indent="10mm">C'ieng Tamlung of C'ieng Mai
  </fo:block>

</fo:float>
```

## See Also

- `fo:footnote` -- another out-of-line formatting object for footnote content
- `fo:marginalia` -- out-of-line formatting object for margin notes
- `fo:block-container` -- can be used for absolutely positioned content
