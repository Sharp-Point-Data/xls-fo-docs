# fo:conditional-page-master-reference

## Summary

The `fo:conditional-page-master-reference` is used to identify a page-master that is to be used when the conditions on its use are satisfied. This allows different page-masters to be used, for example, for even and odd pages, for the first page in a page-sequence, for the third page in a page-sequence cycle, or for blank pages. This usage is typical in chapters of a book or report where the first page has a different layout than the rest of the chapter and the headings and footings on even and odd pages may be different as well. Selecting page-masters based on position within a cycle is typical of bulk-mailed correspondence that is to be folded into envelopes by a folding machine.

## Areas

The `fo:conditional-page-master-reference` formatting object generates no area directly. It is used by the `fo:page-sequence` formatting object to generate pages.

## Constraints

The `fo:conditional-page-master-reference` has a reference to the `fo:simple-page-master` which has the same `master-name` as the `master-reference` trait on the `fo:conditional-page-master-reference`.

There are three traits that specify the sub-conditions on the use of the referenced page-master. All three sub-conditions must be `true` for the condition on the `fo:conditional-page-master-reference` to be `true`:

### page-position

The sub-condition is `true` if the page generated has the specified position in the sequence of pages:

- **first**: The page is the first page in the page-sequence.
- **last**: The page is the last page in the page-sequence.
- **only**: The page is both first and last (the only page).
- **rest**: The page is not first nor last.
- **any**: Always true regardless of position.
- **\<number\>**: The page number (or position within the page cycle when `sequence-repeats` is not `no-limit`) equals the specified value.

The referencing page-sequence is the `fo:page-sequence` that referenced the `fo:page-sequence-master` from which this `fo:conditional-page-master-reference` is a descendant.

### odd-or-even

The sub-condition is `true` if the value is "any" or if the value matches the parity of the page number:

- **odd**: The page has an odd page number.
- **even**: The page has an even page number.
- **any**: Always true regardless of parity.

### blank-or-not-blank

The sub-condition is `true` if:

- **not-blank**: The page has areas generated by descendants of `fo:flow` formatting objects.
- **blank**: The page has no areas from any `fo:flow` to be put on it (e.g., to maintain proper page parity due to a `break-after`/`break-before` value of "even-page" or "odd-page", or at the start/end of the page-sequence, or because flow constraints would not be satisfied).
- **any**: Always true.

A "blank page" is a page generated under condition (2) above. This has nothing to do with whether the page appears completely blank to the reader (static content such as headers/footers may still appear on blank pages).

Since the properties from which these traits are derived are not inherited and the initial value of all the properties makes the corresponding sub-condition `true`, only the subset of traits derived from properties with specified values must have their corresponding sub-condition be `true`.

## Content Model

<!-- Source: https://www.w3.org/TR/xslfo20/#fo_conditional-page-master-reference -->
```xml
EMPTY
```

The `fo:conditional-page-master-reference` element has no child elements.

## Properties

| Property | Type | Initial Value | Inherited | Conformance Level |
|---|---|---|---|---|
| master-reference | `<name>` | an empty name | no, a value is required | Basic |
| page-position | `<number> \| only \| first \| last \| rest \| any \| inherit` | any | no | Basic |
| odd-or-even | `odd \| even \| any \| inherit` | any | no | Basic |
| blank-or-not-blank | `blank \| not-blank \| any \| inherit` | any | no | Basic |

### Property Details

- **master-reference**: Specifies the name of the page-master to be used whenever this alternative is chosen. The name must not be empty and must refer to a `master-name` in the current or a preceding `fo:layout-master-set`.
- **page-position**: Part of the selection rule. Determines eligibility based on the page's position in the page-sequence or page cycle.
- **odd-or-even**: Part of the selection rule. Determines eligibility based on the parity of the page number.
- **blank-or-not-blank**: Part of the selection rule. Determines eligibility based on whether the page has content from `fo:flow` objects.

## Usage Notes

The `fo:conditional-page-master-reference` is always a child of `fo:repeatable-page-master-alternatives`. Multiple `fo:conditional-page-master-reference` children are evaluated in document order; the first one whose conditions are all satisfied is selected.

Several values can be true simultaneously. For example, `any` is always true, and `only` is true when both `first` and `last` are true. For that reason, it is necessary to order `fo:conditional-page-master-reference` elements so that the least inclusive test is performed before the more inclusive test.

A typical ordering for a book chapter:

1. `page-position="first"` -- captures the first page
2. `blank-or-not-blank="blank" odd-or-even="even"` -- captures forced even blank pages
3. `blank-or-not-blank="blank" odd-or-even="odd"` -- captures forced odd blank pages
4. `odd-or-even="odd"` -- captures odd (right-hand) pages
5. `odd-or-even="even"` -- captures even (left-hand) pages

When `page-position` is set to a numeric value and `sequence-repeats` on the parent `fo:repeatable-page-master-alternatives` is not `no-limit`, the number refers to the position within the repeating cycle rather than the absolute page number.

## Code Samples

No code samples in spec for this formatting object. The spec section contains only the content model declaration shown above.

## See Also

- fo:repeatable-page-master-alternatives -- parent container
- fo:page-sequence-master -- grandparent that defines the overall page selection sequence
- fo:simple-page-master -- the page-master referenced by master-reference
- fo:page-master -- alternative page-master that may be referenced
