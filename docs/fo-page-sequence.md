# fo:page-sequence

## Summary

The `fo:page-sequence` formatting object is used to specify how to create a (sub-)sequence of pages within a document; for example, a chapter of a report. The content of these pages comes from flow children of the `fo:page-sequence` as assigned by the flow-map in effect for that `fo:page-sequence`. The layout of these pages comes from the `fo:page-sequence-master` or page-master referenced by the `master-reference` trait on the `fo:page-sequence`. The sequence of areas returned by each of the flow-object children of the `fo:page-sequence` are made descendants of the generated pages.

## Areas

The `fo:page-sequence` generates a sequence of viewport/reference pairs, and returns the page-viewport-areas. For each page-reference-area, and each region specified in the page-master used to generate that page-reference-area, the `fo:page-sequence` also generates the viewport/reference pair for the occurrence of that region in that page-reference-area, and may generate a before-float-reference-area, footnote-reference-area, main-reference-area, and one or more normal-flow-reference-areas. It may also generate a title-area.

All areas generated by an `fo:page-sequence` have area-class "xsl-absolute".

The page-viewport-areas identify one of the sides as a page binding edge. The specification does not define the mechanism for selecting which side is the page binding edge.

## Trait Derivation

The `reference-orientation` and `writing-mode` of the region-viewport-areas are determined by the values of the `reference-orientation` and `writing-mode` properties of the `fo:page-sequence`. The value may be given as an explicit value or the `from-page-master-region` function may be used to obtain the value specified on the layout formatting object being used to generate the region viewport/reference area pair.

## Constraints

Each page-viewport-area/page-reference-area pair is generated using a page-master that satisfies the constraints of the page-sequence-master identified by the `master-reference` trait of the `fo:page-sequence` or a page-master that was directly identified by the `master-reference` trait. The region-viewport-area children of such a page-reference-area must correspond to the regions that are children of that page-master.

The areas returned to the `fo:page-sequence` by a flow must satisfy five types of constraints:

1. **Completeness**: All areas returned by formatting object descendants of the flow children become descendants of areas generated by the `fo:page-sequence`.
2. **Flow-map association**: The areas returned from a flow child must be descendants of region-reference-areas generated using regions to which the flow is assigned by the flow-map in effect.
3. **Area-class association**: Areas are distributed based on their area-class (xsl-footnote to footnote-reference-area, xsl-before-float to before-float-reference-area, all others to region-reference-area/main-reference-area).
4. **Stacking**: The stackable areas of a given class returned by children of each flow are properly stacked within the appropriate reference-area.
5. **Flow-assignment ordering**: The default ordering constraint does not apply to the `fo:page-sequence` itself but applies to the flow object children inside each `fo:flow`.

If the `flow-map-reference` is specified, the flow-map in effect is the closest preceding `fo:flow-map` having a `flow-map-name` matching the specified value. If `flow-map-reference` is not specified, the implicit flow-map is used.

## Content Model

<!-- Source: https://www.w3.org/TR/xslfo20/#fo_page-sequence -->
```xml
(title?,folio-prefix?,folio-suffix?,static-content*,flow+)
```

An optional `fo:title`, optional `fo:folio-prefix`, optional `fo:folio-suffix`, zero or more `fo:static-content` elements, followed by one or more `fo:flow` elements.

## Properties

| Property | Type | Initial Value | Inherited | Conformance Level |
|---|---|---|---|---|
| country | `none \| <country> \| inherit` | none | yes | Basic |
| flow-map-reference | `<name>` | see prose | no | Extended |
| format | `<string>` | 1 | no | Basic |
| language | `none \| <language> \| inherit` | none | yes | Basic |
| letter-value | `auto \| alphabetic \| traditional` | auto | no | Basic |
| grouping-separator | `<character>` | no separator | no | Basic |
| grouping-size | `<number>` | no grouping | no | Basic |
| id | `<id>` | see prose | no | Basic |
| index-class | `<string>` | empty string | no | Extended |
| index-key | `<string>` | none | no | Extended |
| initial-page-number | `auto \| auto-odd \| auto-even \| <number> \| inherit` | auto | no | Basic |
| force-page-count | `auto \| even \| odd \| end-on-even \| end-on-odd \| no-force \| inherit` | auto | no | Basic |
| master-reference | `<name>` | an empty name | no, a value is required | Basic |
| reference-orientation | `0 \| 90 \| 180 \| 270 \| -90 \| -180 \| -270 \| inherit` | 0 | no | Basic |
| writing-mode | `lr-tb \| rl-tb \| tb-rl \| tb-lr \| ... \| inherit` | lr-tb | no | Basic |

### Key Property Details

- **master-reference**: Names the page-sequence-master or page-master used to generate the pages in this sequence. A value is required; the name must match a `master-name` in the current or a preceding `fo:layout-master-set`.
- **initial-page-number**: Sets the starting page number. `auto` continues from the previous page-sequence (or starts at 1). `auto-odd` and `auto-even` ensure the starting number has the correct parity.
- **force-page-count**: Constrains the total number of pages. `auto` ensures proper page parity with the next page-sequence. `even`/`odd` forces an even/odd total. `end-on-even`/`end-on-odd` forces the last page to be even/odd. `no-force` imposes no constraint.
- **format**, **letter-value**, **grouping-separator**, **grouping-size**: Control how page numbers are formatted into strings (as specified in XSLT Number to String Conversion).
- **country**, **language**: Specify locale for language-coupled services such as hyphenation.
- **flow-map-reference**: Names the flow-map controlling how flows are assigned to regions.

## Usage Notes

The `fo:page-sequence` is the primary structural element for document content. Each logical section of a document (chapter, appendix, etc.) is typically represented as a separate `fo:page-sequence`.

The `master-reference` property must point to either a `fo:simple-page-master` (for a single page layout) or a `fo:page-sequence-master` (for varying page layouts, e.g., different first/odd/even pages).

Static content (headers, footers) is placed in `fo:static-content` elements, which are repeated on every page that has the corresponding region. The main body content goes in one or more `fo:flow` elements.

Page numbering is controlled by `initial-page-number` and `force-page-count`. For double-sided printing, use `force-page-count="end-on-even"` to ensure each chapter starts on a right-hand (odd) page.

## Code Samples

No code samples in spec for this formatting object. The spec section contains only the content model declaration shown above.

## See Also

- fo:root -- parent element
- fo:page-sequence-master -- defines the sequence of page masters used
- fo:simple-page-master -- defines a single page layout
- fo:page-master -- defines an arbitrary page layout with multiple regions
- fo:flow -- contains the flowing content for the page-sequence
- fo:static-content -- contains repeated content (headers/footers)
- fo:title -- optional title for the page-sequence
- fo:page-sequence-wrapper -- groups page-sequences for inherited properties
- fo:flow-map -- controls assignment of flows to regions
